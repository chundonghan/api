<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.es.dao.ums.UserDao">
	<!-- 用户登录 -->
	<select id="login" parameterType="Map"  resultType="Map">
		SELECT 
			a.USER_ID,a.NICKNAME,a.AVATAR 
		FROM user a
		WHERE 
			DEL_FLAG = '0'
			AND
			(
				ACCOUNT = #{account} 
				OR
				EMAIL = #{account} 
				OR
				MOBILE_PHONE = #{account} 
			)
			AND
			PASSWD = #{passwd}
	</select>
	
	<!-- 获取系统列表 -->
	<select id="getSystemList" parameterType="Map"  resultType="Map">
		SELECT 
			a.SYSTEM_ID,a.SYSTEM_NAME,a.SYSTEM_URL,a.SYSTEM_ICON
		FROM system_info a
		INNER JOIN unit_system_relation b ON a.SYSTEM_ID = b.SYSTEM_ID
		INNER JOIN unit c ON c.UNIT_ID = b.UNIT_ID
		INNER JOIN unit_user_relation d ON d.UNIT_ID = c.UNIT_ID
		INNER JOIN user e ON e.USER_ID = d.USER_ID AND e.USER_ID = #{user_id}
	</select>
</mapper>